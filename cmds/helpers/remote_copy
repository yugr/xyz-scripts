#/bin/sh

# Copyright 2026 Yury Gribov
#â–«
# Use of this source code is governed by MIT license that can be
# found in the LICENSE.txt file.

# Fast copy through remote server

set -eu

SRC=$1
DST=$2

SRV=tools-srv4

LINUX_SRC=$(get_linux_path $SRC)
LINUX_DST=$(get_linux_path $DST)

# Chdir necessary to inform Linux of recently created folders
ssh -o 'BatchMode yes' $SRV "cd $LINUX_SRC && cd $LINUX_DST && cp -rT $LINUX_SRC $LINUX_DST && chmod -R a+rwx $LINUX_DST || (echo >&2 'COPY FAILED' && exit 1)"

